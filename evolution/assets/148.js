(window.webpackJsonp=window.webpackJsonp||[]).push([[148],{1208:function(t,e,n){"use strict";n.r(e);var s=n(2147),a=n(1885);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var i=n(0),o=n(2592),l=n.n(o),u=Object(i.a)(a.default,s.a,s.b,!1,null,null,null);"function"==typeof l.a&&l()(u),e.default=u.exports},1876:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,a=n(3),r=(s=a)&&s.__esModule?s:{default:s},i=n(13),o=n(23);e.default={props:{id:{type:String,required:!1}},data:function(){return{request:null,reconnects:0,responseText:"",status:"",showFilesize:!1}},computed:(0,r.default)({requestURL:function(){return"/CMD_ADMIN_BACKUP?action=monitor&get=tracking_data&pid="+this.id+"&rand="+Math.random()},recconectsLimitReached:function(){return this.reconnects>=20},progress:function(){return Number(this.getLineWith("set_percent",13,-3))||0},dynamicText:function(){return(0,o.toAppString)(this.getLineWith("dynamic_text",51,-2))},dynamicDetails:function(){return(0,o.toAppString)(this.getLineWith("dynamic_details",54,-2))},filesize:function(){return this.getLineWith("set_filesize",14,-3)}},(0,i.mapResponse)({GET_ADMIN_CURRENT_BACKUP:"backup"})),created:function(){this.MAX_RECONNECTS_LIMIT=20},watch:{filesize:function(){this.showFilesize||(this.showFilesize=!0)},dynamicDetails:function(){this.showFilesize=!1}},methods:{createRequest:function(){this.$request("GET_ADMIN_CURRENT_BACKUP",{pid:this.id});var t=new XMLHttpRequest,e=function(e,n){return t.addEventListener(e,n,!1)};return e("load",this.handleLoad),e("progress",this.handleProgress),e("error",this.handleError),this.request=t,t},connect:function(){this.request||this.createRequest(),this.recconectsLimitReached||(this.reconnects+=1,this.request.open("GET",this.requestURL),this.request.send())},handleLoad:function(){this.responseText=this.request.responseText,this.progress<100?(this.status=this.$gettext("Lost connection to tracker. Re-connecting."),this.connect()):this.status=this.$gettext("Tracker stream was closed.")},handleProgress:function(){this.responseText=this.request.responseText},handleError:function(){this.status=this.$gettext("Error getting backup details")},updateCurrentBackups:function(){this.$request("GET_ADMIN_CURRENT_BACKUPS")},getLineWith:function(t,e,n){var s=this.responseText.split("\n").filter(function(e){return e.includes(t)});return s.length?s.pop().slice(e,n):""}}}},1877:function(t,e,n){"use strict";n.r(e);var s=n(1876),a=n.n(s);for(var r in s)"default"!==r&&function(t){n.d(e,t,function(){return s[t]})}(r);e.default=a.a},1878:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(n(8)),a=i(n(16)),r=i(n(7));function i(t){return t&&t.__esModule?t:{default:t}}e.default={data:function(){return{message:!0,local_ns:!1,restore_spf:!0,confirm_with_domainowners:!0}},methods:{loadSettings:function(){var t=this;return(0,r.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a.default,e.t1=t,e.next=4,t.$request("GET_ADMIN_BACKUP_SETTINGS");case 4:e.t2=e.sent,(0,e.t0)(e.t1,e.t2);case 6:case"end":return e.stop()}},e,t)}))()},saveSettings:function(){this.$actionRequest("UPDATE_ADMIN_BACKUP_SETTINGS",this.$data)}}}},1879:function(t,e,n){"use strict";n.r(e);var s=n(1878),a=n.n(s);for(var r in s)"default"!==r&&function(t){n.d(e,t,function(){return s[t]})}(r);e.default=a.a},1880:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=r(n(8)),a=r(n(7));function r(t){return t&&t.__esModule?t:{default:t}}e.default={data:function(){return{select:[]}},methods:{killBackup:function(){var t=this;return(0,a.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$request("KILL_CURRENT_BACKUP",t.$get("select"),{reset:!0});case 2:t.$request("GET_ADMIN_CURRENT_BACKUPS");case 3:case"end":return e.stop()}},e,t)}))()},getDataLabels:function(t){var e={domain:this.$gettext("Domain Directory"),subdomain:this.$gettext("Subdomain Lists"),ftp:this.$gettext("FTP Accounts"),ftpsettings:this.$gettext("FTP Settings"),database:this.$gettext("Database Settings"),database_data:this.$gettext("Database Data"),forwarder:this.$gettext("Forwarders"),email:this.$gettext("E-mail Accounts"),email_data:this.$gettext("E-mail Data"),emailsettings:this.$gettext("E-mail Settings"),vacation:this.$gettext("Vacation Messages"),autoresponder:this.$gettext("Autoresponders"),list:this.$gettext("Mailing Lists")};return t.map(function(t){return e[t]}).join(", ")}}}},1881:function(t,e,n){"use strict";n.r(e);var s=n(1880),a=n.n(s);for(var r in s)"default"!==r&&function(t){n.d(e,t,function(){return s[t]})}(r);e.default=a.a},1882:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{select:[]}},methods:{duplicateCrons:function(){this.$actionRequest("ADMIN_CRON_DUPLICATE",this.$get("select"),{reset:!0})},deleteCrons:function(){this.$actionRequest("ADMIN_CRON_DELETE",this.$get("select"),{reset:!0})},getDataLabels:function(t){var e={domain:this.$gettext("Domain Directory"),subdomain:this.$gettext("Subdomain Lists"),ftp:this.$gettext("FTP Accounts"),ftpsettings:this.$gettext("FTP Settings"),database:this.$gettext("Database Settings"),database_data:this.$gettext("Database Data"),forwarder:this.$gettext("Forwarders"),email:this.$gettext("E-mail Accounts"),email_data:this.$gettext("E-mail Data"),emailsettings:this.$gettext("E-mail Settings"),vacation:this.$gettext("Vacation Messages"),autoresponder:this.$gettext("Autoresponders"),list:this.$gettext("Mailing Lists")};return t.map(function(t){return e[t]}).join(", ")}}}},1883:function(t,e,n){"use strict";n.r(e);var s=n(1882),a=n.n(s);for(var r in s)"default"!==r&&function(t){n.d(e,t,function(){return s[t]})}(r);e.default=a.a},1884:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=f(n(8)),a=f(n(7)),r=f(n(3)),i=n(13),o=n(27),l=f(n(2596)),u=f(n(2595)),c=f(n(2594)),d=f(n(2593));function f(t){return t&&t.__esModule?t:{default:t}}e.default=(0,r.default)({},(0,i.preload)(["GET_ADMIN_CRONS_LIST","GET_ADMIN_CURRENT_BACKUPS"]),{mixins:[(0,o.$bindTab)({defaultTab:"scheduled",param:"tab"})],components:{CronsTable:l.default,CurrentBackupsTable:u.default,BackupRestoreSettingsDialog:c.default,MonitorBackupStatusDialog:d.default},data:function(){return{select:[],refreshTimeout:3e4,refresh:!0,viewDialogPid:void 0}},computed:(0,r.default)({},(0,i.mapResponse)({GET_ADMIN_CURRENT_BACKUPS:"currentBackups",GET_ADMIN_CRONS_LIST:"crons"}),{haveBackupsRunning:function(){return!!this.currentBackups.rowsCount}}),watch:{haveBackupsRunning:function(t,e){!t&&e&&this.changeTab("scheduled")}},methods:{refreshCurrentBackups:function(){var t=this;return(0,a.default)(s.default.mark(function e(){return s.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.refresh){e.next=3;break}return e.next=3,t.$request("GET_ADMIN_CURRENT_BACKUPS",{},{silent:!0});case 3:t.timeoutId=setTimeout(t.refreshCurrentBackups,t.refreshTimeout);case 4:case"end":return e.stop()}},e,t)}))()},showDetails:function(t){this.viewDialogPid=t,this.$dialog("MONITOR_BACKUP_STATUS_DIALOG").open()}},mounted:function(){var t=this;this.refreshCurrentBackups(),"in-progress"!==this.tab||this.haveBackupsRunning||this.$nextTick(function(){t.tab="scheduled"})},beforeDestroy:function(){clearTimeout(this.timeoutId)}})},1885:function(t,e,n){"use strict";n.r(e);var s=n(1884),a=n.n(s);for(var r in s)"default"!==r&&function(t){n.d(e,t,function(){return s[t]})}(r);e.default=a.a},1926:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-dialog",{attrs:{id:"BACKUP_RESTORE_SETTINGS"},on:{"dialog:open":t.loadSettings}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Backup/Restore Settings")]),t._v(" "),n("template",{slot:"content"},[n("ui-form-element",[n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.message,callback:function(e){t.message=e},expression:"message"}},[n("translate",[t._v("Send a message when a backup has finished.")])],1)],1),t._v(" "),n("ui-form-element",[n("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir:'column' }"}],attrs:{slot:"content"},slot:"content"},[n("input-check",{attrs:{type:"radio",value:!0},model:{value:t.local_ns,callback:function(e){t.local_ns=e},expression:"local_ns"}},[n("translate",[t._v("\n                        Restore with local NameServers.\n                    ")])],1),t._v(" "),n("input-check",{attrs:{type:"radio",value:!1},model:{value:t.local_ns,callback:function(e){t.local_ns=e},expression:"local_ns"}},[n("translate",[t._v("\n                        Use NS values from backup.\n                    ")])],1)],1)]),t._v(" "),n("ui-form-element",[n("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir:'column' }"}],attrs:{slot:"content"},slot:"content"},[n("input-check",{attrs:{type:"radio",value:!0},model:{value:t.restore_spf,callback:function(e){t.restore_spf=e},expression:"restore_spf"}},[n("translate",[t._v("\n                        Restore with SPF values from backup.\n                    ")])],1),t._v(" "),n("input-check",{attrs:{type:"radio",value:!1},model:{value:t.restore_spf,callback:function(e){t.restore_spf=e},expression:"restore_spf"}},[n("translate",[t._v("\n                        Use local SPF values.\n                    ")])],1)],1)]),t._v(" "),n("ui-form-element",[n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.confirm_with_domainowners,callback:function(e){t.confirm_with_domainowners=e},expression:"confirm_with_domainowners"}},[n("translate",[t._v("On restore, check for domain conflict in domainowners, rather than the named.conf, or remote named.conf files.")])],1)],1)],1),t._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"safe"},on:{click:t.saveSettings},slot:"buttons"},[n("translate",[t._v("Save")])],1)],2)},a=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return a})},1927:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-api-table",t._b({on:{"action:kill":t.killBackup},scopedSlots:t._u([{key:"col:start",fn:function(e){var s=e.start;return[n("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir: 'column' }"}]},[n("translate",{attrs:{"translate-params":s}},[t._v("Minute: %{minute}")]),t._v(" "),n("translate",{attrs:{"translate-params":s}},[t._v("Hour: %{hour}")]),t._v(" "),n("translate",{attrs:{"translate-params":s}},[t._v("Day of Month: %{dayofmonth}")]),t._v(" "),n("translate",{attrs:{"translate-params":s}},[t._v("Month: %{month}")]),t._v(" "),n("translate",{attrs:{"translate-params":s}},[t._v("Day of Week: %{dayofweek}")])],1)]}},{key:"col:who",fn:function(e){var s=e.who;return["all"===s.who?n("translate",[t._v("All Users")]):"selected"===s.who?[n("translate",{attrs:{tag:"strong"}},[t._v("Selected Users:")]),t._v(" "),t._l(s.select,function(e){return n("li",[t._v(t._s(e))])})]:[n("translate",{attrs:{tag:"strong"}},[t._v("All Users Except:")]),t._v(" "),t._l(s.select,function(e){return n("li",[t._v(t._s(e))])})],t._v(" "),"yes"===s.skip_suspended?n("ui-tooltip",{attrs:{theme:"danger",icon:"warning"}},[n("translate",[t._v("Skip Suspended")])],1):t._e()]}},{key:"col:what",fn:function(e){var s=e.what;return["all"===s.what?n("translate",[t._v("\n            All Data\n        ")]):[t._v("\n            "+t._s(t.getDataLabels(s.select))+"\n        ")]]}},{key:"col:progress",fn:function(e){var s=e.progress;return n("ui-progress",{attrs:{theme:"safe",size:"big",value:s}},[t._v("\n        "+t._s(s)+"%\n    ")])}},{key:"col:details",fn:function(e){var s=e.pid;return n("ui-button",{attrs:{theme:"light",size:"small"},on:{click:function(e){t.$emit("showDetails",s)}}},[n("translate",[t._v("Details")])],1)}}]),model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},"ui-api-table",{endpoint:"GET_ADMIN_CURRENT_BACKUPS",rowID:"pid",columns:{pid:t.$gettext("PID"),id:t.$gettext("Backup ID"),start:t.$gettext("Start Time"),who:t.$gettext("Who"),where:t.$gettext("Where"),progress:t.$gettext("Progress"),details:null},actions:{kill:t.$gettext("Kill")},updateOn:[]},!1))},a=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return a})},1928:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-page-section",[n("ui-api-table",t._b({on:{"action:duplicate":t.duplicateCrons,"action:del":function(e){t.$dialog("DELETE_ITEMS_DIALOG").open()}},scopedSlots:t._u([{key:"col:when",fn:function(e){var s=e.when;return[n("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir: 'column' }"}]},[n("translate",{attrs:{"translate-params":s}},[t._v("Minute: %{minute}")]),t._v(" "),n("translate",{attrs:{"translate-params":s}},[t._v("Hour: %{hour}")]),t._v(" "),n("translate",{attrs:{"translate-params":s}},[t._v("Day of Month: %{dayofmonth}")]),t._v(" "),n("translate",{attrs:{"translate-params":s}},[t._v("Month: %{month}")]),t._v(" "),n("translate",{attrs:{"translate-params":s}},[t._v("Day of Week: %{dayofweek}")])],1)]}},{key:"col:who",fn:function(e){var s=e.who;return["all"===s.who?n("translate",[t._v("All Users")]):"selected"===s.who?[n("translate",{attrs:{tag:"strong"}},[t._v("Selected Users:")]),t._v(" "),t._l(s.select,function(e){return n("li",[t._v(t._s(e))])})]:[n("translate",{attrs:{tag:"strong"}},[t._v("All Users Except:")]),t._v(" "),t._l(s.select,function(e){return n("li",[t._v(t._s(e))])})],t._v(" "),"yes"===s.skip_suspended?n("ui-tooltip",{attrs:{theme:"danger",icon:"warning"}},[n("translate",[t._v("Skip Suspended")])],1):t._e()]}},{key:"col:what",fn:function(e){var s=e.what;return["all"===s.what?n("translate",[t._v("\n                All Data\n            ")]):[t._v("\n                "+t._s(t.getDataLabels(s.select))+"\n            ")]]}},{key:"col:inline-actions",fn:function(e){var s=e.id;return[n("ui-actions",{attrs:{position:"left"}},[n("ui-link",{attrs:{name:"admin/backups/modify",params:{id:s}}},[n("translate",[t._v("Modify")])],1)],1)]}}]),model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},"ui-api-table",{endpoint:"GET_ADMIN_CRONS_LIST",rowID:"id",columns:{when:t.$gettext("When"),who:t.$gettext("Who"),where:t.$gettext("Where"),what:t.$gettext("What"),"inline-actions":null},updateOn:["ADMIN_CRON_DELETE","ADMIN_CRON_DUPLICATE"],actions:{duplicate:t.$gettext("Duplicate"),del:t.$gettext("Delete")}},!1)),t._v(" "),n("ui-dialog-delete-items",{attrs:{subject:t.$ngettext("scheduled backup","scheduled backups",t.select.length)},on:{"click:confirm":t.deleteCrons}})],1)},a=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return a})},2004:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-dialog",{attrs:{noCloseBtn:"",id:"MONITOR_BACKUP_STATUS_DIALOG",size:"normal"},on:{"dialog:open":t.connect,"dialog:close":t.updateCurrentBackups}},[n("translate",{attrs:{slot:"title","translate-params":{id:t.id}},slot:"title"},[t._v("\n        Monitor Backup: %{ id }\n    ")]),t._v(" "),n("template",{slot:"content"},[Object.keys(t.backup).length?n("ui-base-table",{attrs:{columns:{id:t.$gettext("Backup ID"),owner:t.$gettext("Owner"),start:t.$gettext("Start Time"),who:t.$gettext("Who"),where:t.$gettext("Where")}}},[n("ui-table-row",[n("span",{attrs:{slot:"col:id"},domProps:{textContent:t._s(t.backup.id)},slot:"col:id"}),t._v(" "),n("span",{attrs:{slot:"col:owner"},domProps:{textContent:t._s(t.backup.owner)},slot:"col:owner"}),t._v(" "),n("span",{attrs:{slot:"col:start"},slot:"col:start"},[t._v("\n                    "+t._s(t._f("date")(t.backup.start))+"\n                ")]),t._v(" "),n("ul",{attrs:{slot:"col:who"},slot:"col:who"},["all"===t.backup.who.who?n("translate",[t._v("All Users")]):"selected"===t.backup.who.who?[n("translate",{attrs:{tag:"strong"}},[t._v("Selected Users:")]),t._v(" "),t._l(t.backup.who.select,function(e){return n("li",[t._v(t._s(e))])})]:[n("translate",{attrs:{tag:"strong"}},[t._v("All Users Except:")]),t._v(" "),t._l(t.backup.who.select,function(e){return n("li",[t._v(t._s(e))])})],t._v(" "),"yes"===t.backup.who.skip_suspended?n("ui-tooltip",{attrs:{theme:"danger",icon:"warning"}},[n("translate",[t._v("Skip Suspended")])],1):t._e()],2),t._v(" "),n("span",{attrs:{slot:"col:where"},domProps:{textContent:t._s(t.backup.where)},slot:"col:where"})])],1):t._e(),t._v(" "),t.progress?n("ui-progress",{attrs:{value:t.progress,size:"big",theme:"primary"}},[t._v("\n            "+t._s(t.progress)+" %\n        ")]):t._e(),t._v(" "),n("ui-form-element",[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Overview:")]),t._v(" "),n("span",{attrs:{slot:"content"},slot:"content"},[t._v("\n                "+t._s(t.dynamicText)+"\n            ")])],1),t._v(" "),t.progress<100?n("ui-form-element",[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Details:")]),t._v(" "),n("span",{attrs:{slot:"content"},slot:"content"},[t._v("\n                "+t._s(t.dynamicDetails)+"\n                "),t.showFilesize?n("template",{slot:"content"},[t._v("\n                    - "+t._s(t.filesize)+"\n                ")]):t._e()],2)],1):t._e(),t._v(" "),n("ui-form-element",{attrs:{vertical:""}},[t.recconectsLimitReached?n("translate",{attrs:{slot:"content","translate-params":{limit:t.MAX_RECONNECTS_LIMIT}},slot:"content"},[t._v("\n                We have already reconnected %{ limit } times. Refresh the page if you want to try again.\n            ")]):n("span",{attrs:{slot:"content"},slot:"content"},[t._v("\n                "+t._s(t.status)+"\n            ")])],1)],1)],2)},a=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return a})},2147:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-page",[n("template",{slot:"header:buttons"},[n("ui-button-link",{attrs:{theme:"safe",name:"admin/backups/schedule"}},[n("translate",[t._v("Schedule")])],1),t._v(" "),n("ui-button-link",{attrs:{theme:"primary",name:"admin/backups/restore"}},[n("translate",[t._v("Restore")])],1)],1),t._v(" "),n("app-page-section",[n("ui-tabs",{attrs:{tabs:[{id:"scheduled",label:t.$gettext("Scheduled Backups")},t.haveBackupsRunning?{id:"in-progress",label:t.$gettext("In Progress")}:{}],selected:t.tab,hideSingleTab:""},on:{"update:selected":function(e){t.tab=e}}},[n("crons-table",{attrs:{slot:"tab:scheduled"},slot:"tab:scheduled"}),t._v(" "),n("current-backups-table",{attrs:{slot:"tab:in-progress"},on:{showDetails:t.showDetails},slot:"tab:in-progress"})],1)],1),t._v(" "),n("backup-restore-settings-dialog"),t._v(" "),n("monitor-backup-status-dialog",t._b({},"monitor-backup-status-dialog",{id:t.viewDialogPid},!1)),t._v(" "),n("ui-link",{attrs:{slot:"bottom:links",bullet:""},on:{click:function(e){t.$dialog("BACKUP_RESTORE_SETTINGS").open()}},slot:"bottom:links"},[n("translate",[t._v("Backup/Restore Settings")])],1)],2)},a=[];n.d(e,"a",function(){return s}),n.d(e,"b",function(){return a})},2592:function(t,e){},2593:function(t,e,n){"use strict";n.r(e);var s=n(2004),a=n(1877);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var i=n(0),o=Object(i.a)(a.default,s.a,s.b,!1,null,null,null);e.default=o.exports},2594:function(t,e,n){"use strict";n.r(e);var s=n(1926),a=n(1879);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var i=n(0),o=Object(i.a)(a.default,s.a,s.b,!1,null,null,null);e.default=o.exports},2595:function(t,e,n){"use strict";n.r(e);var s=n(1927),a=n(1881);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var i=n(0),o=Object(i.a)(a.default,s.a,s.b,!1,null,null,null);e.default=o.exports},2596:function(t,e,n){"use strict";n.r(e);var s=n(1928),a=n(1883);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);var i=n(0),o=Object(i.a)(a.default,s.a,s.b,!1,null,null,null);e.default=o.exports}}]);